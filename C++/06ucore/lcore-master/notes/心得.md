操作系统作为内核,通过各种机制向提供应用程序服务.学习内核的过程有一大困难:我们通常是先学"机制",即内核是如何"提供"服务的,而在写代码时是要"建立"这样的服务.在建立的过程中,往往难以有可以上手的环境去测试,或者不知道如何去验证自己写的是否正确,只能像写文科题目一样,按照理论的步骤去添加代码.这种感觉很不好.

现代操作系统经过多年的进化,尽管有一些历史原因留下的坑,但其中很多设计非常巧妙,非常精炼.这也导致了很多设计目标互相耦合.但仔细挖掘后,我们可以尽量把这些机制"线性"化,目标是把这些零碎的知识"点"最后连接成有机的"知识".


1. 访问内存
   1. 地址翻译
   2. 地址检查
   3. 缺页异常处理
   4. 页面置换

讲义:

## 1. 虚拟化


----

## 学习方法

在学习一个新的机制时,首先要按照自己的想法,自底向上地思考.为了完成这个工作,至少需要那些接口?需要哪些数据结构?然后再考虑上层的东西.

- 理论学习:top-down
- 工程学习:down-top

- 理论的关注点:问题定义,流程归纳,状态转换,要素定义,数据结构,方案设计与比较,图示描述
- 实践的关注点:数据结构,非主题但必需的问题讨论,代码讲解
- 阅读代码不畅,很可能是基础不牢.需要下降,把底层的代码了解清楚
- 在阅读代码细节之前,先想想如果我来实现,会如何实现?会用到哪些结构?

链表专门用于虚拟化!!

## 关于机制:

## ucore 模块划分

- 进程管理
- 中断管理
- 内存管理
- 设备管理

## 进程的创建

- 分配内存
- 加载可执行文件

## 基础内核进程

- idle 进程,负责所有内核进程的调度
- init_main,负责创建用户进程管理者
- user_main,负责创建用户进程

## 特权级切换: int iret

## 编程思想

资源管理思想

资源池+索引值

- 内存分配
- 打开文件列表